<?xml version='1.0' encoding="UTF-8" ?>{% comment %}<!--

  This schema essentially declares our <app:featureName> to be a subclass of <gml:AbstractFeatureType>.
  Thus, elements like <gml:name> and <gml:boundedBy> are also supported.

-->{% endcomment %}
<schema
   xmlns="http://www.w3.org/2001/XMLSchema"
   xmlns:app="{{ app_xml_namespace }}"
   xmlns:gml="http://www.opengis.net/gml/3.2"
   targetNamespace="{{ app_xml_namespace }}"
   elementFormDefault="qualified" version="0.1" >

  <import namespace="http://www.opengis.net/gml/3.2" schemaLocation="http://schemas.opengis.net/gml/3.2.1/gml.xsd" />

{% for feature_type in feature_types %}
  <element name="{{ feature_type.name }}" type="app:{{ feature_type.name }}Type" substitutionGroup="gml:AbstractFeature" />

  <complexType name="{{ feature_type.name }}Type">
    <complexContent>
      <extension base="gml:AbstractFeatureType">
        <sequence>{% for name, xs_type in feature_type.fields_with_type %}
          <element name="{{ name }}" type="{{ xs_type }}" minOccurs="0"{% if xs_type.prefix == "gml" %} maxOccurs="1"{% endif %}/>{% endfor %}
        </sequence>
      </extension>
    </complexContent>
  </complexType>
{% endfor %}

</schema>
